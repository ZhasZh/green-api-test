<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>GREEN API Test</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background:#f2f3f7;
        margin:0;
        padding:0;
    }

    .container {
        display: flex;
        gap: 25px;
        padding: 40px;
        max-width: 1300px;
        margin: auto;
    }

    .left-panel, .right-panel {
        background:white;
        border-radius:12px;
        padding:25px;
        box-shadow:0 5px 15px rgba(0,0,0,.1);
    }

    .left-panel {
        width:330px;
        display:flex;
        flex-direction:column;
        gap:14px;
    }

    input, textarea, button {
        width:100%;
        padding:10px;
        font-size:15px;
        border-radius:8px;
        border:1px solid #ccc;
        box-sizing:border-box;
    }

    button {
        background:#4CAF50;
        color:white;
        border:none;
        cursor:pointer;
        font-weight:bold;
        transition:.25s;
    }

    button:hover {
        background:#45a049;
    }

    .right-panel {
        flex:1;
    }

    .title {
        font-size:20px;
        font-weight:bold;
        margin-bottom:10px;
    }

    textarea {
        height:500px;
        resize:both;
        font-family:monospace;
        white-space:pre-wrap;
        overflow:auto;
    }
</style>
</head>

<body>

<div class="container">
    
    <div class="left-panel">
        <input id="idInstance" placeholder="idInstance">
        <input id="ApiTokenInstance" placeholder="ApiTokenInstance">

        <button onclick="getSettings()">getSettings</button>
        <button onclick="getStateInstance()">getStateInstance</button>

        <input id="phone" placeholder="77071234567">
        <input id="message" placeholder="Ваш текст">

        <button onclick="sendMessage()">sendMessage</button>

        <input id="filePhone" placeholder="77071234567">
        <input id="fileUrl" placeholder="https://example.com/file.jpg">

        <button onclick="sendFileByUrl()">sendFileByUrl</button>
    </div>

    <div class="right-panel">
        <div class="title">Ответ:</div>
        <textarea id="response" readonly></textarea>
    </div>
</div>


<script>
async function sendRequest(method, data={}) {
    const id = document.getElementById("idInstance").value;
    const token = document.getElementById("ApiTokenInstance").value;

    const url = `https://api.green-api.com/waInstance${id}/${method}/${token}`;
    const res = await fetch(url,{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:Object.keys(data).length ? JSON.stringify(data) : null
    });

    document.getElementById("response").value = await res.text();
}

// ===== API Методы =====
function getSettings()       { sendRequest("getSettings"); }
function getStateInstance()  { sendRequest("getStateInstance"); }
function sendMessage() {
    sendRequest("sendMessage",{
        chatId: document.getElementById("phone").value+"@c.us",
        message: document.getElementById("message").value
    });
}
function sendFileByUrl() {
    sendRequest("sendFileByUrl",{
        chatId: document.getElementById("filePhone").value+"@c.us",
        urlFile: document.getElementById("fileUrl").value,
        fileName:"file"
    });
}
</script>

</body>
</html>
