<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Тестовое задание GREEN-API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
            background-color: #f7f7f7;
        }
        h1 {
            color: #333;
        }
        input, textarea, button {
            display: block;
            margin: 10px 0;
            padding: 8px;
            font-size: 14px;
        }
        textarea {
            width: 100%;
            height: 200px;
            resize: vertical;
        }
        button {
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>

<h1>GREEN-API Тестовое задание</h1>

<label>idInstance:</label>
<input type="text" id="idInstance" placeholder="Введите idInstance">

<label>ApiTokenInstance:</label>
<input type="text" id="apiTokenInstance" placeholder="Введите ApiTokenInstance">

<label>Телефон получателя (в формате 770XXXXXXX@c.us):</label>
<input type="text" id="phone" placeholder="Например, 77012345678@c.us">

<label>Сообщение для отправки:</label>
<input type="text" id="message" placeholder="Текст сообщения">

<label>Ссылка на файл для отправки:</label>
<input type="text" id="fileUrl" placeholder="URL файла">

<button onclick="getSettings()">getSettings</button>
<button onclick="getStateInstance()">getStateInstance</button>
<button onclick="sendMessage()">sendMessage</button>
<button onclick="sendFileByUrl()">sendFileByUrl</button>

<label>Ответ API:</label>
<textarea id="responseField" readonly></textarea>

<script>
    const responseField = document.getElementById("responseField");

    function getSettings() {
        const idInstance = document.getElementById("idInstance").value;
        const apiTokenInstance = document.getElementById("apiTokenInstance").value;

        fetch(`https://api.green-api.com/waInstance${idInstance}/getSettings/${apiTokenInstance}`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({})
        })
        .then(res => res.json())
        .then(data => {
            responseField.value = JSON.stringify(data, null, 2);
        })
        .catch(err => responseField.value = "Ошибка: " + err);
    }

    function getStateInstance() {
        const idInstance = document.getElementById("idInstance").value;
        const apiTokenInstance = document.getElementById("apiTokenInstance").value;

        fetch(`https://api.green-api.com/waInstance${idInstance}/getStateInstance/${apiTokenInstance}`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({})
        })
        .then(res => res.json())
        .then(data => {
            responseField.value = JSON.stringify(data, null, 2);
        })
        .catch(err => responseField.value = "Ошибка: " + err);
    }

    function sendMessage() {
        const idInstance = document.getElementById("idInstance").value;
        const apiTokenInstance = document.getElementById("apiTokenInstance").value;
        const phone = document.getElementById("phone").value;
        const message = document.getElementById("message").value;

        fetch(`https://api.green-api.com/waInstance${idInstance}/sendMessage/${apiTokenInstance}`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                chatId: phone,
                message: message
            })
        })
        .then(res => res.json())
        .then(data => {
            responseField.value = JSON.stringify(data, null, 2);
        })
        .catch(err => responseField.value = "Ошибка: " + err);
    }

    function sendFileByUrl() {
        const idInstance = document.getElementById("idInstance").value;
        const apiTokenInstance = document.getElementById("apiTokenInstance").value;
        const phone = document.getElementById("phone").value;
        const fileUrl = document.getElementById("fileUrl").value;

        fetch(`https://api.green-api.com/waInstance${idInstance}/sendFileByUrl/${apiTokenInstance}`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                chatId: phone,
                url: fileUrl,
                caption: "Файл для теста"
            })
        })
        .then(res => res.json())
        .then(data => {
            responseField.value = JSON.stringify(data, null, 2);
        })
        .catch(err => responseField.value = "Ошибка: " + err);
    }
</script>

</body>
</html>
